name: CI - Lint

on:
  push:
    branches: [main]
    paths:
      - '.github/workflows/*.yml'
      - 'docker/docker-compose.yml'
      - '.pre-commit-config.yaml'
      - '.github/workflows/ci-lint.yml'
  pull_request:
    branches: [main]
    paths:
      - '.github/workflows/*.yml'
      - 'docker/docker-compose.yml'
      - '.pre-commit-config.yaml'
      - '.github/workflows/ci-lint.yml'
  workflow_dispatch:

jobs:
  # Validate GitHub Actions workflows and YAML files
  validate-yaml:
    name: Validate YAML & Workflows
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Install yamllint
        run: pip install yamllint

      - name: Validate YAML files
        run: |
          yamllint -d "{extends: relaxed, rules: {line-length: {max: 200}}}" \
            .github/workflows/*.yml \
            docker/docker-compose.yml \
            .pre-commit-config.yaml

      - name: Install actionlint
        run: |
          bash <(curl -s https://raw.githubusercontent.com/rhysd/actionlint/main/scripts/download-actionlint.bash)
          sudo mv actionlint /usr/local/bin/

      - name: Validate GitHub Actions workflows
        run: actionlint
